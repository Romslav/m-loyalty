# 01 ‚Äî –ü–æ–ª–Ω—ã–π –û–±–∑–æ—Ä –°–∏—Å—Ç–µ–º—ã Max Loyalty

> **–°—Ç–∞—Ç—É—Å:** üîÑ –í —Ä–∞–±–æ—Ç–µ  
> **–°–µ—Å—Å–∏–∏:** S-01 (1/7) ‚Üí S-07 (7/7)  
> **–¶–µ–ª–µ–≤–æ–π –æ–±—ä—ë–º:** ~420 kb  
> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-02-20

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ß–∞—Å—Ç—å 1 ‚Äî –í–≤–µ–¥–µ–Ω–∏–µ, –≥–ª–æ—Å—Å–∞—Ä–∏–π, –∫–æ–Ω—Ü–µ–ø—Ü–∏—è, –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å, —Ä–æ–ª–∏ RBAC](#—á–∞—Å—Ç—å-1)
- [–ß–∞—Å—Ç—å 2 ‚Äî Auth-—Å–∏—Å—Ç–µ–º–∞, –º—É–ª—å—Ç–∏–∞—Ä–µ–Ω–¥–Ω–æ—Å—Ç—å, rate-limiting](#—á–∞—Å—Ç—å-2) *(S-02)*
- [–ß–∞—Å—Ç—å 3 ‚Äî Loyalty Engine: –ø—Ä–∞–≤–∏–ª–∞, —É—Ä–æ–≤–Ω–∏, –ø—Ä–æ–º–æ](#—á–∞—Å—Ç—å-3) *(S-03)*
- [–ß–∞—Å—Ç—å 4 ‚Äî POS-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: iiko, R-Keeper, webhook-flow](#—á–∞—Å—Ç—å-4) *(S-04)*
- [–ß–∞—Å—Ç—å 5 ‚Äî Frontend Admin Panel, Manager Dashboard, Cashier](#—á–∞—Å—Ç—å-5) *(S-05)*
- [–ß–∞—Å—Ç—å 6 ‚Äî Telegram Mini App, Notifications, Billing](#—á–∞—Å—Ç—å-6) *(S-06)*
- [–ß–∞—Å—Ç—å 7 ‚Äî Analytics, Infrastructure, Security, GDPR](#—á–∞—Å—Ç—å-7) *(S-07)*

---

# –ß–∞—Å—Ç—å 1

# –í–≤–µ–¥–µ–Ω–∏–µ. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è. –ì–ª–æ—Å—Å–∞—Ä–∏–π. –ë–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å. –†–æ–ª–∏ RBAC

---

## 1.1 –ß—Ç–æ —Ç–∞–∫–æ–µ Max Loyalty

**Max Loyalty** ‚Äî —ç—Ç–æ –º–Ω–æ–≥–æ—Ç–µ–Ω–∞–Ω—Ç–Ω–∞—è (multi-tenant) B2B SaaS-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞. –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ç—è–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º –∑–∞–≤–µ–¥–µ–Ω–∏—è–º –∑–∞–ø—É—Å–∫–∞—Ç—å, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Å—Å–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ, –±–µ–∑ –ø–æ–∫—É–ø–∫–∏ –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–µ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏ –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞.

### –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è

–†–µ—Å—Ç–æ—Ä–∞–Ω–Ω—ã–π –±–∏–∑–Ω–µ—Å –≤ –†–æ—Å—Å–∏–∏ –∏ –°–ù–ì –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —Å—Ç–∞–ª–∫–∏–≤–∞–µ—Ç—Å—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏:

1. **–ü—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∫ POS-—Å–∏—Å—Ç–µ–º–µ.** –ü—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ iiko –∏–ª–∏ R-Keeper —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Å–≤–æ–µ–π —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã, –Ω–µ –ø–æ–∑–≤–æ–ª—è—è –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –∫–∞—Å—Å—É –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –±–∞–∑—ã –≥–æ—Å—Ç–µ–π.
2. **–í—ã—Å–æ–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≥–æ—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π.** –ö—Ä—É–ø–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (Plazius, –ö–æ—à–µ–ª—ë–∫, Mindbox) —Å—Ç–æ—è—Ç –¥–µ—Å—è—Ç–∫–∏ —Ç—ã—Å—è—á —Ä—É–±–ª–µ–π –≤ –º–µ—Å—è—Ü –∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –∫—Ä—É–ø–Ω—ã–π –±–∏–∑–Ω–µ—Å.
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–∏–±–∫–æ—Å—Ç–∏.** –°–ª–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω: –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –±–ª—é–¥, —É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞, –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–∏ –ø–æ —Å–ª—É—á–∞—é –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
4. **–ù–µ—Ç –µ–¥–∏–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.** –î–∞–Ω–Ω—ã–µ –æ –≥–æ—Å—Ç—è—Ö, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω—ã –ø–æ —Ä–∞–∑–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º.

**Max Loyalty** —Ä–µ—à–∞–µ—Ç –≤—Å–µ —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è:

- –ï–¥–∏–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç—å—é, **–Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –æ—Ç POS-—Å–∏—Å—Ç–µ–º—ã**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å iiko Cloud, iiko Server, R-Keeper, Poster —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–æ–π –∞–¥–∞–ø—Ç–µ—Ä–æ–≤
- Telegram Mini App –¥–ª—è –≥–æ—Å—Ç–µ–π ‚Äî –±–µ–∑ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –ì–∏–±–∫–∏–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–∞–≤–∏–ª –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∏ —Å–ø–∏—Å–∞–Ω–∏—è –±–∞–ª–ª–æ–≤
- –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–¥–ø–∏—Å–æ—á–Ω—É—é –º–æ–¥–µ–ª—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ (FREE ‚Üí CUSTOM) —Å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø–∞—Ä–∞–¥–∏–≥–º–∞

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –∫–∞–∫ **Modular Monolith** ‚Äî –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —á—ë—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥—É–ª–∏. –≠—Ç–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–æ—Ç–∏–≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–∞ —ç—Ç–∞–ø–µ MVP:

```
Modular Monolith (–≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥)
‚îú‚îÄ‚îÄ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–µ–ø–ª–æ—è ‚Äî 1 –ø—Ä–æ—Ü–µ—Å—Å API + 1 Worker + 1 Cron
‚îú‚îÄ‚îÄ –û–±—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî –Ω–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
‚îú‚îÄ‚îÄ –ï–¥–∏–Ω—ã–π —Å—Ç–µ–∫ ‚Äî NestJS + Prisma + TypeScript –≤–µ–∑–¥–µ
‚îî‚îÄ‚îÄ –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (–æ—Ç–ª–æ–∂–µ–Ω–æ –Ω–∞ Scale-—Ñ–∞–∑—É –ø—Ä–∏ 50k+ –≥–æ—Å—Ç–µ–π)
```

### –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

| –°–µ–≥–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---------|----------|--------|
| –û–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω | 1 –∑–∞–≤–µ–¥–µ–Ω–∏–µ, 1 Admin, 1‚Äì3 –∫–∞—Å—Å–∏—Ä–∞ | –°–µ–º–µ–π–Ω—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω |
| –ú–∞–ª–∞—è —Å–µ—Ç—å | 2‚Äì5 —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤, –µ–¥–∏–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ | –ù–µ–±–æ–ª—å—à–∞—è —Å–µ—Ç—å –∫–æ—Ñ–µ–µ–Ω |
| –°—Ä–µ–¥–Ω—è—è —Å–µ—Ç—å | 5‚Äì20 —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤, –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ | –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–µ—Ç—å |
| –ö—Ä—É–ø–Ω–∞—è —Å–µ—Ç—å | 20+ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤, –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø–ª–∞–Ω | –§–µ–¥–µ—Ä–∞–ª—å–Ω–∞—è —Å–µ—Ç—å |

---

## 1.2 –ì–ª–æ—Å—Å–∞—Ä–∏–π

–ü–æ–ª–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å —Ç–µ—Ä–º–∏–Ω–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤–æ –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –≤ –∫–æ–¥–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

| –¢–µ—Ä–º–∏–Ω | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------------------|----------|
| **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞** | Platform | –í—Å—è —Å–∏—Å—Ç–µ–º–∞ Max Loyalty —Ü–µ–ª–∏–∫–æ–º |
| **–ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä / –¢–µ–Ω–∞–Ω—Ç** | `Tenant` | –ö–æ–º–ø–∞–Ω–∏—è (—Å–µ—Ç—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤), –∞—Ä–µ–Ω–¥—É—é—â–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—É. –û—Å–Ω–æ–≤–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –ö–∞–∂–¥–æ–º—É Tenant —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ |
| **–†–µ—Å—Ç–æ—Ä–∞–Ω** | `Restaurant` | –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ–Ω–∞–Ω—Ç–∞. –£ –æ–¥–Ω–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç 1 –¥–æ N —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–∞–Ω–∞) |
| **–ì–æ—Å—Ç—å** | `GuestProfile` | –ü–æ—Å–µ—Ç–∏—Ç–µ–ª—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞, —É—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏. –û–¥–∏–Ω –≥–æ—Å—Ç—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∫–∞—Ä—Ç—ã –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞—Ö –æ–¥–Ω–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞ |
| **–ö–∞—Ä—Ç–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏** | `GuestCard` | –ö–∞—Ä—Ç–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≥–æ—Å—Ç—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ (–∏–ª–∏ —Å–µ—Ç–∏). –°–æ–¥–µ—Ä–∂–∏—Ç –±–∞–ª–∞–Ω—Å –±–∞–ª–ª–æ–≤, —É—Ä–æ–≤–µ–Ω—å, QR-–∫–æ–¥ |
| **–ë–∞–ª–ª** | Ball | –ï–¥–∏–Ω–∏—Ü–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ. –ú–æ–∂–µ—Ç –Ω–∞—á–∏—Å–ª—è—Ç—å—Å—è –∏ —Å–ø–∏—Å—ã–≤–∞—Ç—å—Å—è. –ù–µ —è–≤–ª—è–µ—Ç—Å—è –¥–µ–Ω–µ–∂–Ω–æ–π –µ–¥–∏–Ω–∏—Ü–µ–π |
| **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±–∞–ª–ª–æ–≤** | `BallTransaction` | –ó–∞–ø–∏—Å—å –æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –∏–ª–∏ —Å–ø–∏—Å–∞–Ω–∏–∏ –±–∞–ª–ª–æ–≤. –í—Å–µ–≥–¥–∞ –∏–º–µ–µ—Ç –ø—Ä–∏—á–∏–Ω—É (`reason`) –∏ –∞–≤—Ç–æ—Ä–∞ (`createdBy`) |
| **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è POS** | `POSTransaction` | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, –ø—Ä–∏—à–µ–¥—à–∞—è –∏–∑ –∫–∞—Å—Å–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (iiko, R-Keeper –∏ –¥—Ä.) |
| **–ü—Ä–∞–≤–∏–ª–æ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏** | `LoyaltyRule` | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –ø—Ä–∞–≤–∏–ª–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –±–∞–ª–ª–æ–≤: % –æ—Ç —Å—É–º–º—ã —á–µ–∫–∞, –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –±–ª—é–¥, –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∏ —Ç.–¥. |
| **–£—Ä–æ–≤–µ–Ω—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏** | `LoyaltyLevel` | –°—Ç–∞—Ç—É—Å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –≥–æ—Å—Ç—è (–ë—Ä–æ–Ω–∑–∞, –°–µ—Ä–µ–±—Ä–æ, –ó–æ–ª–æ—Ç–æ, –ü–ª–∞—Ç–∏–Ω–∞). –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è |
| **–ü—Ä–æ–º–æ-–∞–∫—Ü–∏—è** | `LoyaltyPromo` | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ —É—Å–ª–æ–≤–∏—é –∞–∫—Ü–∏—è: –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ –∑–∞ –ø–µ—Ä–≤—ã–π —á–µ–∫, –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è, –¥–æ–ª–≥–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ |
| **–ü—Ä–æ–º–æ-–±–∞–ª–ª—ã** | `PromoBalance` | –ë–∞–ª–ª—ã, –Ω–∞—á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø–æ –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–∏. –ò–º–µ—é—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
| **–û–±—ã—á–Ω—ã–µ –±–∞–ª–ª—ã** | `RegularBalance` | –ë–∞–ª–ª—ã, –Ω–∞—á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º. –ù–µ –∏–º–µ—é—Ç —Å—Ä–æ–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏–Ω–æ–µ) |
| **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≥–æ—Å—Ç—è** | `GuestVisit` | –ó–∞–ø–∏—Å—å –æ –≤–∏–∑–∏—Ç–µ –≥–æ—Å—Ç—è –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω (–∏–∑ POS –∏–ª–∏ —Ä—É—á–Ω–∞—è) |
| **–†–µ–±—ë–Ω–æ–∫ –≥–æ—Å—Ç—è** | `GuestChild` | –î–∞–Ω–Ω—ã–µ –æ –¥–µ—Ç—è—Ö –≥–æ—Å—Ç—è –¥–ª—è –ø—Ä–æ–º–æ –∫–æ –¥–Ω—é —Ä–æ–∂–¥–µ–Ω–∏—è —Ä–µ–±—ë–Ω–∫–∞ |

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã

| –¢–µ—Ä–º–∏–Ω | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| **Multi-tenant pooled** | –í—Å–µ —Ç–µ–Ω–∞–Ω—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `tenantId` –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ |
| **Soft delete** | –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –ø—É—Ç—ë–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `deletedAt` –≤–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –ë–î. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç GDPR-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ –∞—É–¥–∏—Ç |
| **Impersonation** | –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ Owner –ø–æ–¥ –∞–∫–∫–∞—É–Ω—Ç–æ–º Admin –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è |
| **Reconciliation** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –±–∞–ª–ª–æ–≤ –º–µ–∂–¥—É Max Loyalty –∏ POS-—Å–∏—Å—Ç–µ–º–æ–π. –í—ã—è–≤–ª—è–µ—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è |
| **Idempotency** | –°–≤–æ–π—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–∏: –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ —Å —Ç–µ–º –∂–µ `idempotencyKey` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è |
| **One-Way-Up** | –ü—Ä–∏–Ω—Ü–∏–ø –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏: —É—Ä–æ–≤–µ–Ω—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ–≤—ã—Å–∏—Ç—å, –ø–æ–Ω–∏–∑–∏—Ç—å –Ω–µ–ª—å–∑—è (–µ—Å–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏–Ω–æ–µ) |
| **Webhook** | HTTP-–∑–∞–ø—Ä–æ—Å –æ—Ç POS-—Å–∏—Å—Ç–µ–º—ã –∫ –Ω–∞—à–µ–º—É API –ø—Ä–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∫–∏ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ |
| **PUSH-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** | POS —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ Max Loyalty —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫ –≤ –º–æ–º–µ–Ω—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ |
| **PULL-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** | Max Loyalty —Å–∞–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç) –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ POS –ø–æ API |
| **Sandbox** | –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º POS-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è, –Ω–æ –∫ —Ä–µ–∞–ª—å–Ω—ã–º –±–∞–ª–∞–Ω—Å–∞–º –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è |
| **Grace period** | –ü–µ—Ä–∏–æ–¥ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è/–ø—Ä–æ—Å—Ä–æ—á–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç –æ—Å—Ç–∞—ë—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ READ-ONLY |
| **RBAC** | Role-Based Access Control ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π |
| **JWT** | JSON Web Token ‚Äî —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. Access token –∂–∏–≤—ë—Ç 15 –º–∏–Ω—É—Ç, Refresh token ‚Äî 30 –¥–Ω–µ–π |
| **BullMQ** | –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—á–µ—Ä–µ–¥–µ–π –∑–∞–¥–∞—á –Ω–∞ –æ—Å–Ω–æ–≤–µ Redis –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —Å–≤–µ—Ä–∫–∏) |
| **Prisma** | ORM (Object-Relational Mapper) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL —á–µ—Ä–µ–∑ TypeScript |
| **TenantLimits** | –ó–∞–ø–∏—Å—å –≤ –ë–î —Å –ª–∏–º–∏—Ç–∞–º–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞: –º–∞–∫—Å. –≥–æ—Å—Ç–µ–π, —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∞—Ä–∏—Ñ–æ–º |

### –ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã

| –ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞ | –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ |
|-------------|-------------|
| **POS** | Point of Sale ‚Äî –∫–∞—Å—Å–æ–≤–∞—è/—Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (iiko, R-Keeper, Poster) |
| **MRR** | Monthly Recurring Revenue ‚Äî –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –¥–æ—Ö–æ–¥ |
| **ARR** | Annual Recurring Revenue ‚Äî –≥–æ–¥–æ–≤–æ–π —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –¥–æ—Ö–æ–¥ |
| **ARPU** | Average Revenue Per User ‚Äî —Å—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –æ–¥–Ω–æ–≥–æ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–∞ |
| **LTV** | Lifetime Value ‚Äî —Å—É–º–º–∞—Ä–Ω—ã–π –¥–æ—Ö–æ–¥ –æ—Ç –æ–¥–Ω–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞ –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è |
| **Churn** | –û—Ç—Ç–æ–∫ ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç —Ç–µ–Ω–∞–Ω—Ç–æ–≤, –æ—Ç–∫–∞–∑–∞–≤—à–∏—Ö—Å—è –æ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ |
| **RFM** | Recency, Frequency, Monetary ‚Äî –º–µ—Ç–æ–¥ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≥–æ—Å—Ç–µ–π |
| **OTP** | One-Time Password ‚Äî –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| **2FA / MFA** | Two/Multi-Factor Authentication ‚Äî –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| **GDPR** | General Data Protection Regulation ‚Äî –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–π —Ä–µ–≥–ª–∞–º–µ–Ω—Ç –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö |
| **HMAC** | Hash-based Message Authentication Code ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ –≤–µ–±—Ö—É–∫–∞ |
| **SSE** | Server-Sent Events ‚Äî —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∫ –±—Ä–∞—É–∑–µ—Ä—É |
| **CDN** | Content Delivery Network ‚Äî —Å–µ—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ |
| **CI/CD** | Continuous Integration / Continuous Deployment ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ –∏ –¥–µ–ø–ª–æ—è |

---

## 1.3 –ö–æ–Ω—Ü–µ–ø—Ü–∏—è SaaS-–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö: Multi-tenant Pooled

Max Loyalty –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **pooled multi-tenancy** ‚Äî –≤—Å–µ —Ç–µ–Ω–∞–Ω—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –µ–¥–∏–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL, –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç `tenantId`. –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è B2B SaaS –Ω–∞ —ç—Ç–∞–ø–µ —Ä–æ—Å—Ç–∞.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  PostgreSQL Database                 ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  Tenant A   ‚îÇ  ‚îÇ  Tenant B   ‚îÇ  ‚îÇ  Tenant C   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ "–í–∫—É—Å–Ω–æ"    ‚îÇ  ‚îÇ "–ü–∏—Ü—Ü–∞&Co" ‚îÇ  ‚îÇ "–°—É—à–∏-–±–∞—Ä"  ‚îÇ ‚îÇ
‚îÇ  ‚îÇ tenantId=1  ‚îÇ  ‚îÇ tenantId=2  ‚îÇ  ‚îÇ tenantId=3  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö, –∏–∑–æ–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ WHERE  ‚îÇ
‚îÇ  tenantId = :currentTenantId (Prisma middleware)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü–æ—á–µ–º—É pooled, –∞ –Ω–µ isolated (–æ—Ç–¥–µ–ª—å–Ω–∞—è –ë–î –Ω–∞ —Ç–µ–Ω–∞–Ω—Ç–∞)?**

| –ö—Ä–∏—Ç–µ—Ä–∏–π | Pooled (–≤—ã–±—Ä–∞–Ω–æ) | Isolated |
|----------|-----------------|---------|
| –°—Ç–æ–∏–º–æ—Å—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–µ–ø–ª–æ—è | –ü—Ä–æ—Å—Ç–∞—è | –°–ª–æ–∂–Ω–∞—è |
| –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö | –õ–æ–≥–∏—á–µ—Å–∫–∞—è (tenantId) | –§–∏–∑–∏—á–µ—Å–∫–∞—è |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ | –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ + —à–∞—Ä–¥–∏–Ω–≥ | –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ |
| –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –Ω–æ–≤–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞ | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ | –ú–∏–Ω—É—Ç—ã (–ø—Ä–æ–≤–∏–∂–∏–Ω–∏–Ω–≥ –ë–î) |
| –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ñ–∞–∑—ã | MVP ‚Üí PMF | Scale+ |

–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ isolated –º–æ–¥–µ–ª—å –≤–æ–∑–º–æ–∂–µ–Ω –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∏–ª–∏ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 500+ —Ç–µ–Ω–∞–Ω—Ç–æ–≤.

### –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Prisma Middleware

–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ `tenantId` —á–µ—Ä–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã–π Prisma middleware:

```typescript
// libs/prisma/src/middleware/tenant.middleware.ts
export function tenantMiddleware(tenantId: string) {
  return async (params: Prisma.MiddlewareParams, next: (params: Prisma.MiddlewareParams) => Promise<any>) => {
    // –î–æ–±–∞–≤–ª—è–µ–º tenantId –≤ WHERE –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è
    if (params.action === 'findMany' || params.action === 'findFirst') {
      params.args = params.args || {};
      params.args.where = {
        ...params.args.where,
        tenantId,
        deletedAt: null, // Soft delete —Ñ–∏–ª—å—Ç—Ä
      };
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º tenantId –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø–∏—Å–µ–π
    if (params.action === 'create') {
      params.args.data = {
        ...params.args.data,
        tenantId,
      };
    }
    
    return next(params);
  };
}
```

Middleware –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ `JwtAuthGuard` –ø–æ—Å–ª–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ —Ç–æ–∫–µ–Ω–∞:

```typescript
// –ò–∑ JWT —Ç–æ–∫–µ–Ω–∞ –±–µ—Ä—ë—Ç—Å—è tenantId
const tenantId = request.user.tenantId;

// Prisma-–∫–ª–∏–µ–Ω—Ç —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Ç–µ–Ω–∞–Ω—Ç—É
const prisma = this.prismaService.$extends(tenantMiddleware(tenantId));
```

---

## 1.4 –ë–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å –∏ —Ç–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã

### –ü–æ–¥–ø–∏—Å–æ—á–Ω—ã–µ –ø–ª–∞–Ω—ã

Max Loyalty —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –º–æ–¥–µ–ª–∏ **–ø–æ–¥–ø–∏—Å–∫–∏** (recurring subscription). –ï—Å—Ç—å 6 —Ç–∞—Ä–∏—Ñ–æ–≤:

| –¢–∞—Ä–∏—Ñ | –†–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ | –ì–æ—Å—Ç–µ–π | –¶–µ–Ω–∞/–º–µ—Å (—Ä—É–±.) | –¶–µ–Ω–∞/–≥–æ–¥ (—Ä—É–±.) | –¶–µ–ª–µ–≤–æ–π –∫–ª–∏–µ–Ω—Ç |
|-------|-----------|--------|-----------------|-----------------|----------------|
| **FREE** | 1 | –î–æ 500 | 0 | 0 | –¢–µ—Å—Ç/—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –≤–ª–∞–¥–µ–ª–µ—Ü Owner |
| **STANDARD** | 1 | –î–æ 5 000 | 4 000 | 48 000 | –û–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω |
| **MEDIUM** | –î–æ 3 | –î–æ 15 000 | 12 000 | 144 000 | –ú–∞–ª–∞—è —Å–µ—Ç—å |
| **PRO** | –î–æ 5 | –î–æ 35 000 | 28 000 | 336 000 | –°—Ä–µ–¥–Ω—è—è —Å–µ—Ç—å |
| **ULTIMATE** | –ë–µ–∑ –ª–∏–º–∏—Ç–∞ | –ë–µ–∑ –ª–∏–º–∏—Ç–∞ | –ü–æ –∑–∞–ø—Ä–æ—Å—É | –ü–æ –∑–∞–ø—Ä–æ—Å—É | –ö—Ä—É–ø–Ω–∞—è —Å–µ—Ç—å |
| **CUSTOM** | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è | –î–æ–≥–æ–≤–æ—Ä–Ω–∞—è | –î–æ–≥–æ–≤–æ—Ä–Ω–∞—è | Enterprise |

**–ì–æ–¥–æ–≤–∞—è —Å–∫–∏–¥–∫–∞:** 20% (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç 0.8 –∫ –µ–∂–µ–º–µ—Å—è—á–Ω–æ–π —Ü–µ–Ω–µ √ó 12).

**Overage (–ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞):**
- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 90% –ª–∏–º–∏—Ç–∞ –≥–æ—Å—Ç–µ–π ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ Admin —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º upgrade
- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 100% –ª–∏–º–∏—Ç–∞ ‚Üí –Ω–æ–≤—ã–µ –≥–æ—Å—Ç–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è CTA —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç–∞—Ä—à–∏–π —Ç–∞—Ä–∏—Ñ

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ FREE-—Ç–∞—Ä–∏—Ñ—É:**
- –î–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è Owner-–∞–∫–∫–∞—É–Ω—Ç–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
- –ù–∞ FREE –Ω–µ–ª—å–∑—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ–µ–≤—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Owner –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç FREE-—Ç–∞—Ä–∏—Ñ –±–µ–∑ Trial-–ø–µ—Ä–∏–æ–¥–∞

### TenantLimits ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤

–õ–∏–º–∏—Ç—ã –∫–∞–∂–¥–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `TenantLimits`, –∫–æ—Ç–æ—Ä–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏:

```typescript
// –ü—Ä–∏–º–µ—Ä TenantLimits –¥–ª—è —Ç–∞—Ä–∏—Ñ–∞ PRO
{
  tenantId: "tenant-uuid-123",
  maxRestaurants: 5,
  maxGuests: 35000,
  maxManagers: 25,      // –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –Ω–∞ —Ä–µ—Å—Ç–æ—Ä–∞–Ω
  maxCashiers: 50,      // –∫–∞—Å—Å–∏—Ä–æ–≤ —Å—É–º–º–∞—Ä–Ω–æ
  maxApiKeys: 5,        // API-–∫–ª—é—á–µ–π –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
  maxPosIntegrations: 5,
  canExportData: true,
  canUseCustomBranding: true,
  canUseAdvancedAnalytics: true,
  canUseCustomReports: true,
  canUseSmsNotifications: true,
  canUseTelegramBot: true,
}
```

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø–æ–¥–ø–∏—Å–∫–∏

```
[–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Owner] ‚Üí [FREE] ‚Üí [–í—ã–±–æ—Ä –ø–ª–∞–Ω–∞] ‚Üí [ACTIVE]
                                                    ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
                    ‚îÇ                               ‚îÇ
              [–û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞]              [–û–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞]
                    ‚îÇ                               ‚îÇ
               [–ü—Ä–æ–¥–ª–µ–Ω–∏–µ]                   [PAST_DUE]
                                                    ‚îÇ
                                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                    [–î–µ–Ω—å 1]              [–î–µ–Ω—å 7]
                                  [–ü–æ–≤—Ç–æ—Ä –ø–ª–∞—Ç–µ–∂–∞]   [CANCELLED_NON_PAYMENT]
                                                           ‚îÇ
                                                    [READ-ONLY —Ä–µ–∂–∏–º]
                                                    (30 –¥–Ω–µ–π grace period)
```

**Grace period (–ø–µ—Ä–∏–æ–¥ –æ–∂–∏–¥–∞–Ω–∏—è):**
- –ü–æ—Å–ª–µ –æ—Ç–º–µ–Ω—ã –ø–æ–¥–ø–∏—Å–∫–∏ —Ç–µ–Ω–∞–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º **READ-ONLY** –Ω–∞ 30 –¥–Ω–µ–π
- –í READ-ONLY: –Ω–µ–ª—å–∑—è –Ω–∞—á–∏—Å–ª—è—Ç—å/—Å–ø–∏—Å—ã–≤–∞—Ç—å –±–∞–ª–ª—ã, –Ω–µ–ª—å–∑—è –¥–æ–±–∞–≤–ª—è—Ç—å –≥–æ—Å—Ç–µ–π
- –ú–æ–∂–Ω–æ: –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- –ß–µ—Ä–µ–∑ 30 –¥–Ω–µ–π –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ –∞—Ä—Ö–∏–≤ (–Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è, –Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏)

### –ü–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–∞—Ç—ë–∂–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º–µ | –†–µ–≥–∏–æ–Ω | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|-----------|---------------|--------|---------------|
| YooKassa | `YOOKASSA` | –†–æ—Å—Å–∏—è | –û—Å–Ω–æ–≤–Ω–æ–π –¥–ª—è RU |
| Stripe | `STRIPE` | –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π | –î–ª—è –°–ù–ì/EU |
| CloudPayments | `CLOUDPAYMENTS` | –†–æ—Å—Å–∏—è | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |
| CryptoCloud | `CRYPTOCLOUD` | –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π | –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞ |

–î–ª—è **ULTIMATE** –∏ **CUSTOM** –ø–ª–∞–Ω–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–∞ –æ–ø–ª–∞—Ç–∞ –ø–æ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É —Å—á—ë—Ç—É (Invoice). –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ:
1. Owner –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å—á—ë—Ç —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è `Invoice` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `PENDING_MANUAL_PAYMENT`
3. Owner –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –ø–æ –±–∞–Ω–∫–æ–≤—Å–∫–∏–º —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º
4. Owner –æ—Ç–º–µ—á–∞–µ—Ç —Å—á—ë—Ç –∫–∞–∫ –æ–ø–ª–∞—á–µ–Ω–Ω—ã–π ‚Üí `Subscription` –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è

### –í–∞–ª—é—Ç–∞ –∏ –ù–î–°

- –í—Å–µ —Ü–µ–Ω—ã –≤ **—Ä—É–±–ª—è—Ö (RUB)**
- –ù–î–° –≤–∫–ª—é—á—ë–Ω –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å (`vatIncluded: true`)
- –°—Ç–∞–≤–∫–∞ –ù–î–°: **20%**
- –í –∫–∞–∂–¥–æ–º Invoice –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `amountWithoutVat`, `vatRate`, `vatAmount`, `amountWithVat`

---

## 1.5 –ü—è—Ç—å —Ä–æ–ª–µ–π RBAC

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ **5 —Ä–æ–ª—è—Ö** —Å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–º –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∞–≤. –ö–∞–∂–¥–∞—è —Ä–æ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∏ —á—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ.

### –ò–µ—Ä–∞—Ä—Ö–∏—è —Ä–æ–ª–µ–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        OWNER                              ‚îÇ
‚îÇ  (–í–ª–∞–¥–µ–ª–µ—Ü –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Max Loyalty ‚Äî 1 —á–µ–ª–æ–≤–µ–∫)             ‚îÇ
‚îÇ  –í–∏–¥–∏—Ç –í–°–ï —Ç–µ–Ω–∞–Ω—Ç—ã. –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π —Ü–µ–ª–∏–∫–æ–º.         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ —Å–æ–∑–¥–∞—ë—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç
                     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               RESTAURANT ADMIN                            ‚îÇ
‚îÇ  (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–µ—Ç–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ ‚Äî 1 –Ω–∞ —Ç–µ–Ω–∞–Ω—Ç)            ‚îÇ
‚îÇ  –í–∏–¥–∏—Ç –í–°–ï —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã —Å–≤–æ–µ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞.                      ‚îÇ
‚îÇ  –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏.                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    MANAGER                                ‚îÇ
‚îÇ  (–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ ‚Äî N –Ω–∞ —Ä–µ—Å—Ç–æ—Ä–∞–Ω)         ‚îÇ
‚îÇ  –í–∏–¥–∏—Ç 1 —Ä–µ—Å—Ç–æ—Ä–∞–Ω (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ, –µ—Å–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω).         ‚îÇ
‚îÇ  –£–ø—Ä–∞–≤–ª—è–µ—Ç –≥–æ—Å—Ç—è–º–∏, –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏.‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    CASHIER                                ‚îÇ
‚îÇ  (–ö–∞—Å—Å–∏—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ ‚Äî N –Ω–∞ —Ä–µ—Å—Ç–æ—Ä–∞–Ω)           ‚îÇ
‚îÇ  –¢–æ–ª—å–∫–æ: –ø–æ–∏—Å–∫ –≥–æ—Å—Ç—è + –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ/—Å–ø–∏—Å–∞–Ω–∏–µ –±–∞–ª–ª–æ–≤.        ‚îÇ
‚îÇ  PIN-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è. Touch-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                     –æ—Ç–¥–µ–ª—å–Ω–æ:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    GUEST                                  ‚îÇ
‚îÇ  (–ì–æ—Å—Ç—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏)        ‚îÇ
‚îÇ  Telegram Mini App: –±–∞–ª–∞–Ω—Å, –∏—Å—Ç–æ—Ä–∏—è, –ø—Ä–æ–º–æ.               ‚îÇ
‚îÇ  –ù–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Admin Panel.                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### –†–æ–ª—å 1: OWNER (–í–ª–∞–¥–µ–ª–µ—Ü –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)

**Owner** ‚Äî —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Max Loyalty. –≠—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π/–±–∏–∑–Ω–µ—Å-—É—Ä–æ–≤–µ–Ω—å, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–º.

**–ß—Ç–æ –≤–∏–¥–∏—Ç:**
- –í—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ–Ω–∞–Ω—Ç—ã (–∫–æ–º–ø–∞–Ω–∏–∏)
- –í—Å–µ –ø–æ–¥–ø–∏—Å–∫–∏, –ø–ª–∞—Ç–µ–∂–∏, MRR/ARR/Churn
- –ì–ª–æ–±–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ –∏ Activity Log –≤—Å–µ—Ö —Ç–µ–Ω–∞–Ω—Ç–æ–≤

**–ß—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö Restaurant Admin (`OwnerRegistrationLink`)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ç–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
- **Impersonate** (–≤—Ö–æ–¥–∏—Ç—å –ø–æ–¥ –∞–∫–∫–∞—É–Ω—Ç–æ–º –ª—é–±–æ–≥–æ Admin) –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –°–±—Ä–∞—Å—ã–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–Ω–∞–Ω—Ç—ã
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ª—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ –ª—é–±–æ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞
- –£–ø—Ä–∞–≤–ª—è—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (email-—à–∞–±–ª–æ–Ω—ã, SMS-–ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏ —Ç.–¥.)

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
- –†–æ–ª—å –≤ –ë–î: `UserRole.OWNER`
- –ü—Ä–∏–≤—è–∑–∫–∏ –∫ —Ç–µ–Ω–∞–Ω—Ç—É –Ω–µ—Ç (`tenantId = null` –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
- JWT —Å–æ–¥–µ—Ä–∂–∏—Ç `role: 'OWNER'` –∏ `permissions: ['*']` (–≤—Å–µ –ø—Ä–∞–≤–∞)
- –ü—Ä–∏ impersonation JWT —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±–∞ `userId` –∏ `impersonatingUserId`

```typescript
// –ü—Ä–∏–º–µ—Ä JWT payload –¥–ª—è Owner
{
  userId: "owner-uuid",
  email: "admin@max-loyalty.com",
  role: "OWNER",
  tenantId: null,   // null = –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ç–µ–Ω–∞–Ω—Ç–∞–º
  permissions: ["*"],
  iat: 1708425600,
  exp: 1708426500   // 15 –º–∏–Ω—É—Ç
}

// –ü—Ä–∏–º–µ—Ä JWT payload –ø—Ä–∏ impersonation
{
  userId: "owner-uuid",
  impersonatingUserId: "admin-tenant-uuid",
  email: "admin@max-loyalty.com",
  role: "OWNER",
  impersonatingRole: "RESTAURANT_ADMIN",
  impersonatingTenantId: "tenant-uuid-123",
  tenantId: "tenant-uuid-123",  // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Ç–µ–Ω–∞–Ω—Ç –ø—Ä–∏ impersonation
  permissions: ["*"],
}
```

**Owner Dashboard (—á—Ç–æ –≤–∏–¥–∏—Ç –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ):**
- **Platform Overview:** –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ–Ω–∞–Ω—Ç–æ–≤, MRR, ARR
- **Tenant Table:** —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–ø–∞–Ω–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –ø–æ —Ç–∞—Ä–∏—Ñ—É/—Å—Ç–∞—Ç—É—Å—É
- **Churn Analytics:** –∫–æ–≥–æ—Ä—Ç—ã –æ—Ç—Ç–æ–∫–∞, –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–º–µ–Ω—ã
- **Revenue Dashboard:** —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º, –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º –æ–ø–ª–∞—Ç—ã
- **Support Tools:** impersonation, —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª–µ–π, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

---

### –†–æ–ª—å 2: RESTAURANT ADMIN (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–µ—Ç–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤)

**Restaurant Admin** (–≤ –∫–æ–¥–µ: `RESTAURANT_ADMIN`) ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã. –≠—Ç–æ –≤–ª–∞–¥–µ–ª–µ—Ü –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä —Å–µ—Ç–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–ø–∏—Å–∞–ª—Å—è –Ω–∞ Max Loyalty.

**–ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–±–æ—Ç—ã:**
- –ü—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É **Tenant** (`tenantId`)
- –í–∏–¥–∏—Ç –≤—Å–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã —Å–≤–æ–µ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞
- **1 Admin –Ω–∞ Tenant** (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è; –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∞)

**–ß—Ç–æ –≤–∏–¥–∏—Ç:**
- –í—Å–µ –≥–æ—Å—Ç–∏ –ø–æ –≤—Å–µ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º
- –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–±–∞–ª–ª—ã + POS) –ø–æ –≤—Å–µ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º
- –ü–æ–ª–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É: –≤—ã—Ä—É—á–∫—É, ROI –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏, —Å–µ–≥–º–µ–Ω—Ç—ã –≥–æ—Å—Ç–µ–π
- –ü–æ–¥–ø–∏—Å–∫—É –∏ –ø–ª–∞—Ç—ë–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: –∫–æ–º–∞–Ω–¥–∞, POS-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ß—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã (–≤ —Ä–∞–º–∫–∞—Ö –ª–∏–º–∏—Ç–∞ —Ç–∞—Ä–∏—Ñ–∞)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å **Loyalty Builder** (–ø—Ä–∞–≤–∏–ª–∞, —É—Ä–æ–≤–Ω–∏, –ø—Ä–æ–º–æ)
- –£–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥–æ–π: —Å–æ–∑–¥–∞–≤–∞—Ç—å Manager –∏ Cashier –∞–∫–∫–∞—É–Ω—Ç—ã
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å POS-—Å–∏—Å—Ç–µ–º–∞–º–∏ (iiko, R-Keeper)
- –†—É—á–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ/—Å–ø–∏—Å–∞–Ω–∏–µ –±–∞–ª–ª–æ–≤ –≥–æ—Å—Ç—è–º —Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å Telegram Bot –¥–ª—è —Å–≤–æ–µ–π —Å–µ—Ç–∏
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (CSV, XLSX, PDF)
- –£–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–¥–ø–∏—Å–∫–æ–π (upgrade/downgrade, —Å–º–µ–Ω–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –æ–ø–ª–∞—Ç—ã)
- –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ Manager —á–µ—Ä–µ–∑ Dynamic Permissions

**–ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**

Owner —Å–æ–∑–¥–∞—ë—Ç **OwnerRegistrationLink** ‚Äî —Å—Å—ã–ª–∫—É –≤–∏–¥–∞:
```
https://max-loyalty.com/register?token=abc123xyz&plan=STANDARD
```

–ü–æ —ç—Ç–æ–π —Å—Å—ã–ª–∫–µ Restaurant Admin –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é:
1. –í–≤–æ–¥–∏—Ç: –∏–º—è –∫–æ–º–ø–∞–Ω–∏–∏, —Å–≤–æ—ë –∏–º—è, email, —Ç–µ–ª–µ—Ñ–æ–Ω, –ø–∞—Ä–æ–ª—å
2. –í—ã–±–∏—Ä–∞–µ—Ç —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω (Standard/Medium/Pro/Ultimate/Custom)
3. –í–≤–æ–¥–∏—Ç –ø–ª–∞—Ç—ë–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ –Ω–µ FREE)
4. –ü–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ Admin Panel

```typescript
// –ú–æ–¥–µ–ª—å OwnerRegistrationLink –≤ –ë–î
model OwnerRegistrationLink {
  id          String    @id @default(uuid())
  token       String    @unique
  defaultPlan PlanType  @default(STANDARD)
  maxUses     Int       @default(1)
  usedCount   Int       @default(0)
  expiresAt   DateTime?
  createdBy   String    // ownerUserId
  createdAt   DateTime  @default(now())
}
```

**JWT –¥–ª—è Restaurant Admin:**
```typescript
{
  userId: "admin-uuid",
  email: "director@restaurant.ru",
  role: "RESTAURANT_ADMIN",
  tenantId: "tenant-uuid-123",
  permissions: [
    "readGuest:all",
    "createGuest",
    "manageBalls:manual",
    "manageBalls:pos",
    "manageLoyaltySystem",
    "manageLoyaltyDesign",
    "manageLoyaltyPromo",
    "createRestaurant",
    "manageRestaurants",
    "createManager",
    "createCashier",
    "manageUsers",
    "managePermissions",
    "readAnalytics:all",
    "managePosIntegration",
    "manageTelegramBot",
    "manageSubscription",
    "exportData",
    "impersonate"  // —Ç–æ–ª—å–∫–æ Owner –º–æ–∂–µ—Ç impersonate Admin
  ]
}
```

---

### –†–æ–ª—å 3: MANAGER (–ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞)

**Manager** ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ). –°–æ–∑–¥–∞—ë—Ç—Å—è Restaurant Admin –∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º.

**–ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–±–æ—Ç—ã:**
- –ü—Ä–∏–≤—è–∑–∞–Ω –∫ Tenant **–∏** –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É `restaurantId` (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º)
- –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ —Å–≤–æ–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ (–µ—Å–ª–∏ –Ω–µ –¥–∞–Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)

**–ß—Ç–æ –≤–∏–¥–∏—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- –ì–æ—Å—Ç–µ–π —Å–≤–æ–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–≤–æ–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- –ê–Ω–∞–ª–∏—Ç–∏–∫—É —Å–≤–æ–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ (–±–µ–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
- –¢–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (–≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤–æ–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞

**–ß—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- –ü–æ–∏—Å–∫ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª–µ–π –≥–æ—Å—Ç–µ–π
- –†—É—á–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ (—Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º, –∞—É–¥–∏—Ç)
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ü–∏—è–º–∏ (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è Admin ‚Äî `PENDING_APPROVAL`)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Å–≤–æ–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≥–æ—Å—Ç–µ–π (–µ—Å–ª–∏ –¥–∞–Ω–æ –ø—Ä–∞–≤–æ)

**Dynamic Permissions (—Ä–∞—Å—à–∏—Ä—è–µ–º—ã–µ –ø—Ä–∞–≤–∞):**

Admin –º–æ–∂–µ—Ç —Ç–æ—á–µ—á–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ Manager —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Dynamic Permissions`. –ù–∞–ø—Ä–∏–º–µ—Ä:
- –†–∞–∑—Ä–µ—à–∏—Ç—å –≤–∏–¥–µ—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
- –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –ó–∞–ø—Ä–µ—Ç–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

```typescript
// –ü—Ä–∏–º–µ—Ä UserPermission –¥–ª—è Manager
{
  userId: "manager-uuid",
  tenantId: "tenant-uuid",
  restaurantIds: ["restaurant-1", "restaurant-2"],  // –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
  permissions: [
    "readGuest:ownRestaurants",
    "manageBalls:manual",
    "readAnalytics:ownRestaurants",
    // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞, –¥–∞–Ω–Ω—ã–µ Admin-–æ–º:
    "exportData",
    "manageLoyaltyPromo:pendingApproval",  // —Ç–æ–ª—å–∫–æ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
  ]
}
```

**Workflow –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (Approval Workflow):**
```
Manager —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–º–æ ‚Üí —Å—Ç–∞—Ç—É—Å PENDING_APPROVAL
                              ‚îÇ
              Admin –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (Telegram/Email)
                              ‚îÇ
                   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
             [Admin –æ–¥–æ–±—Ä—è–µ—Ç]    [Admin –æ—Ç–∫–ª–æ–Ω—è–µ—Ç]
                   ‚îÇ                     ‚îÇ
            —Å—Ç–∞—Ç—É—Å ACTIVE        —Å—Ç–∞—Ç—É—Å REJECTED
                                    + –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
```

---

### –†–æ–ª—å 4: CASHIER (–ö–∞—Å—Å–∏—Ä)

**Cashier** ‚Äî —Ä—è–¥–æ–≤–æ–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å –≥–æ—Å—Ç—è–º–∏ –Ω–∞ –∫–∞—Å—Å–µ. –ò–º–µ–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –ø—Ä–∞–≤. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–µ/–∫–∞—Å—Å–æ–≤–æ–º —ç–∫—Ä–∞–Ω–µ.

**–ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–±–æ—Ç—ã:**
- –ü—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: **PIN-–∫–æ–¥** (4‚Äì6 —Ü–∏—Ñ—Ä) –≤–º–µ—Å—Ç–æ –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è ‚Äî –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: touch-friendly, –∫—Ä—É–ø–Ω—ã–µ –∫–Ω–æ–ø–∫–∏, —á–∏—Å–ª–æ–≤–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞

**–ß—Ç–æ –≤–∏–¥–∏—Ç:**
- –ë–∞–∑–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥–æ—Å—Ç–µ: –∏–º—è, —É—Ä–æ–≤–µ–Ω—å, –±–∞–ª–∞–Ω—Å –±–∞–ª–ª–æ–≤
- –ò—Å—Ç–æ—Ä–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 5‚Äì10 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≥–æ—Å—Ç—è (—Ç–æ–ª—å–∫–æ —Å–≤–æ–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞)
- –ü—Ä–∏–º–µ–Ω–∏–º—ã–µ –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–∏

**–ß—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å:**
- –ü–æ–∏—Å–∫ –≥–æ—Å—Ç—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É, QR-–∫–æ–¥—É –∏–ª–∏ 6-–∑–Ω–∞—á–Ω–æ–º—É –∫–æ–¥—É
- –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ (–∑–∞ –ø–æ–∫—É–ø–∫—É, —Ä—É—á–Ω–æ–µ —Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º)
- –°–ø–∏—Å–∞–Ω–∏–µ –±–∞–ª–ª–æ–≤ (–¥–ª—è –æ–ø–ª–∞—Ç—ã —á–∞—Å—Ç–∏ –∑–∞–∫–∞–∑–∞)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∏–º–µ–Ω–∏–º—ã—Ö –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–π
- –ü–µ—á–∞—Ç—å —á–µ–∫–∞ —Å –±–∞–ª–∞–Ω—Å–æ–º (thermal printing)

**–ß—Ç–æ –ù–ï –º–æ–∂–µ—Ç:**
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –≥–æ—Å—Ç—è
- –í–∏–¥–µ—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- –£–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
- –°–æ–∑–¥–∞–≤–∞—Ç—å –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–∏—Ö –∫–∞—Å—Å–∏—Ä–æ–≤

```typescript
// JWT –¥–ª—è Cashier
{
  userId: "cashier-uuid",
  role: "CASHIER",
  tenantId: "tenant-uuid",
  restaurantId: "restaurant-uuid",  // —Å—Ç—Ä–æ–≥–æ –æ–¥–∏–Ω —Ä–µ—Å—Ç–æ—Ä–∞–Ω
  permissions: [
    "readGuest:basic",      // —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    "manageBalls:pos",      // –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ/—Å–ø–∏—Å–∞–Ω–∏–µ
    "readTransactions:own", // —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–≤–æ–µ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
  ]
}
```

**PIN-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
```
[–≠–∫—Ä–∞–Ω –∫–∞—Å—Å–∏—Ä–∞] ‚Üí [–í–≤–æ–¥ PIN 4-6 —Ü–∏—Ñ—Ä] ‚Üí [–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ Redis]
                                               ‚îÇ
                                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                               [PIN –≤–µ—Ä–Ω—ã–π]          [PIN –Ω–µ–≤–µ—Ä–Ω—ã–π]
                                    ‚îÇ                     ‚îÇ
                             [–°–µ—Å—Å–∏—è 8 —á–∞—Å–æ–≤]     [–°—á—ë—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫]
                                                    (–º–∞–∫—Å. 5 –ø–æ–ø—ã—Ç–æ–∫,
                                                    –ø–æ—Ç–æ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
                                                    –Ω–∞ 30 –º–∏–Ω—É—Ç)
```

---

### –†–æ–ª—å 5: GUEST (–ì–æ—Å—Ç—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞)

**Guest** ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏. –ù–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Admin Panel. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å —Å–∏—Å—Ç–µ–º–æ–π —á–µ—Ä–µ–∑ **Telegram Mini App** –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–∞—Å—Å–∏—Ä–∞.

**–¢—Ä–∏ —Å–ø–æ—Å–æ–±–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≥–æ—Å—Ç—è:**

1. **–ß–µ—Ä–µ–∑ –∫–∞—Å—Å–∏—Ä–∞** (Cashier Interface):
   - –ö–∞—Å—Å–∏—Ä –≤–≤–æ–¥–∏—Ç —Ç–µ–ª–µ—Ñ–æ–Ω –≥–æ—Å—Ç—è
   - –°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞—ë—Ç `User` + `GuestProfile` + `GuestCard`
   - –ì–æ—Å—Ç—å –ø–æ–ª—É—á–∞–µ—Ç SMS —Å QR-–∫–æ–¥–æ–º –∫–∞—Ä—Ç—ã

2. **–ß–µ—Ä–µ–∑ QR-–∫–æ–¥ / —Å—Å—ã–ª–∫—É** (—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è):
   - Admin –∏–ª–∏ Manager –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
   - –ì–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ, –≤–≤–æ–¥–∏—Ç –∏–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω
   - –ü–æ–ª—É—á–∞–µ—Ç –∫–∞—Ä—Ç—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏

3. **–ß–µ—Ä–µ–∑ Telegram Bot** (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±):
   - –ì–æ—Å—Ç—å –ø–∏—à–µ—Ç –±–æ—Ç—É —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ (`/start`)
   - –ë–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω (OTP-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è)
   - –°–æ–∑–¥–∞—ë—Ç—Å—è `TelegramUser` —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ `GuestProfile`
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Mini App —Å –±–∞–ª–∞–Ω—Å–æ–º, QR-–∫–æ–¥–æ–º, –∏—Å—Ç–æ—Ä–∏–µ–π

**–ß—Ç–æ –≤–∏–¥–∏—Ç –∏ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –≥–æ—Å—Ç—å (—á–µ—Ä–µ–∑ Telegram Mini App):**
- –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –∏ –ø—Ä–æ–º–æ-–±–∞–ª–ª–æ–≤
- –°–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (–ë—Ä–æ–Ω–∑–∞/–°–µ—Ä–µ–±—Ä–æ/–ó–æ–ª–æ—Ç–æ/–ü–ª–∞—Ç–∏–Ω–∞)
- QR-–∫–æ–¥ –∏ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –∫–∞—Ä—Ç—ã –¥–ª—è –ø—Ä–µ–¥—ä—è–≤–ª–µ–Ω–∏—è –∫–∞—Å—Å–∏—Ä—É
- –ò—Å—Ç–æ—Ä–∏—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∏ —Å–ø–∏—Å–∞–Ω–∏—è)
- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–∏
- –ü—Ä–æ—Ñ–∏–ª—å: –∏–º—è, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, –¥–µ—Ç–∏ (–¥–ª—è birthday promo)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏: opt-in/opt-out —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ü–µ—Ä–µ–¥–∞—á–∞ –±–∞–ª–ª–æ–≤ –¥—Ä—É–≥–æ–º—É –≥–æ—Å—Ç—é (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ Admin-–æ–º)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ GuestCard:**
```typescript
// GuestCard ‚Äî –∫–∞—Ä—Ç–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –≥–æ—Å—Ç—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ/—Å–µ—Ç–∏
{
  id: "card-uuid",
  tenantId: "tenant-uuid",
  restaurantId: "restaurant-uuid", // null –¥–ª—è UNIFIED-—Ä–µ–∂–∏–º–∞ (–µ–¥–∏–Ω–∞—è –∫–∞—Ä—Ç–∞)
  guestProfileId: "guest-uuid",
  
  // –ë–∞–ª–∞–Ω—Å
  regularBalance: 2500,     // –æ–±—ã—á–Ω—ã–µ –±–∞–ª–ª—ã
  promoBalance: 500,        // –ø—Ä–æ–º–æ-–±–∞–ª–ª—ã (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Å—Ä–æ–∫–æ–º)
  
  // –£—Ä–æ–≤–µ–Ω—å
  levelId: "silver-level-uuid",
  lifetimeSpent: 45000,     // —Å—É–º–º–∞ –≤—Å–µ—Ö –ø–æ–∫—É–ø–æ–∫ (—Ä—É–±–ª–µ–π) –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —É—Ä–æ–≤–Ω—è
  
  // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
  qrCode: "MAX-TENANT1-GUEST1-CARD1",  // —É–Ω–∏–∫–∞–ª—å–Ω—ã–π QR
  code6Digit: "847291",                 // 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  
  // –°—Ç–∞—Ç—É—Å
  status: "ACTIVE",  // ACTIVE | FROZEN | BLOCKED | INACTIVE | EXPIRED | DELETED
  
  // –¢–µ–ª–µ—Ñ–æ–Ω –ø—Ä–∏–≤—è–∑–∫–∏
  phone: "+79991234567",
  
  // Telegram
  telegramId: "123456789",
  
  createdAt: "2024-03-15T10:00:00Z",
  lastActivityAt: "2024-12-01T15:30:00Z"
}
```

**–°—Ç–∞—Ç—É—Å—ã –∫–∞—Ä—Ç—ã:**

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –ö—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç |
|--------|----------|------------------|
| `ACTIVE` | –ö–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞, –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã | –°–∏—Å—Ç–µ–º–∞ (–ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏) |
| `FROZEN` | –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–º–æ—Ä–æ–∑–∫–∞, –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â–µ–Ω—ã | Manager/Admin |
| `BLOCKED` | –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–Ω–∞—Ä—É—à–µ–Ω–∏–µ) | Admin |
| `INACTIVE` | –ì–æ—Å—Ç—å –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω >180 –¥–Ω–µ–π (–∞–≤—Ç–æ) | CRON-–∑–∞–¥–∞—á–∞ |
| `EXPIRED` | –ö–∞—Ä—Ç–∞ –∏—Å—Ç–µ–∫–ª–∞ (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å—Ä–æ–∫) | CRON-–∑–∞–¥–∞—á–∞ |
| `DELETED` | Soft-delete, GDPR Right to Erasure | Admin (–ø–æ –∑–∞–ø—Ä–æ—Å—É –≥–æ—Å—Ç—è) |

---

### –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤ RBAC

–ü–æ–ª–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è –≤—Å–µ—Ö —Ä–æ–ª–µ–π:

| –ü—Ä–∞–≤–æ | Owner | Admin | Manager | Cashier | Guest |
|-------|-------|-------|---------|---------|-------|
| `readGuest:all` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `readGuest:ownRestaurant` | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| `readGuest:basic` | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |
| `readGuest:self` | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| `createGuest` | ‚úÖ | ‚úÖ | ‚úÖ* | ‚úÖ | ‚ùå |
| `editGuest` | ‚úÖ | ‚úÖ | ‚úÖ* | ‚ùå | ‚úÖ** |
| `deleteGuest` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `manageBalls:manual` | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| `manageBalls:pos` | ‚úÖ | ‚úÖ | ‚ùå | ‚úÖ | ‚ùå |
| `readAnalytics:all` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `readAnalytics:ownRestaurant` | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| `readAnalytics:self` | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| `manageLoyaltySystem` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `manageLoyaltyPromo` | ‚úÖ | ‚úÖ | ‚úÖ*** | ‚ùå | ‚ùå |
| `manageLoyaltyDesign` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `createRestaurant` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `manageRestaurants` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `createManager` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `createCashier` | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| `manageUsers` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `managePermissions` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `managePosIntegration` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `manageTelegramBot` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `manageSubscription` | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `exportData` | ‚úÖ | ‚úÖ | ‚úÖ* | ‚ùå | ‚ùå |
| `impersonate` | ‚úÖ | ‚ùå | ‚ùå | ‚ùå | ‚ùå |
| `editProfile:self` | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| `editChildren:self` | ‚Äî | ‚Äî | ‚Äî | ‚Äî | ‚úÖ |
| `viewCard:own` | ‚Äî | ‚Äî | ‚Äî | ‚Äî | ‚úÖ |
| `transferBalls` | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå | ‚úÖ**** |

> *\* –¢–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —è–≤–Ω–æ –≤—ã–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∞–≤–∞ —á–µ—Ä–µ–∑ Dynamic Permissions*  
> *\*\* –¢–æ–ª—å–∫–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (–∏–º—è, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)*  
> *\*\*\* –¢–æ–ª—å–∫–æ —Å —Ñ–ª–∞–≥–æ–º PENDING\_APPROVAL, —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è Admin*  
> *\*\*\*\* –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ Admin –≤–∫–ª—é—á–∏–ª —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ–¥–∞—á–∏ –±–∞–ª–ª–æ–≤*

---

## 1.6 –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å–∏—Å—Ç–µ–º—ã

### –ü—Ä–∏–Ω—Ü–∏–ø 1: –î–∞–Ω–Ω—ã–µ –≥–æ—Å—Ç—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —Ç–µ–Ω–∞–Ω—Ç—É, –∞ –Ω–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ

–ö–∞–∂–¥—ã–π —Ç–µ–Ω–∞–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –¥–∞–Ω–Ω—ã—Ö —Å–≤–æ–∏—Ö –≥–æ—Å—Ç–µ–π. Owner –Ω–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≥–æ—Å—Ç–µ–π –±–µ–∑ —è–≤–Ω–æ–≥–æ impersonation —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –ü—Ä–∏ —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞ —Ç–µ–Ω–∞–Ω—Ç –º–æ–∂–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ.

### –ü—Ä–∏–Ω—Ü–∏–ø 2: –ê—É–¥–∏—Ç –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è

–ö–∞–∂–¥–æ–µ –∑–Ω–∞—á–∏–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ `ActivityLog`:

```typescript
// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ ActivityLog
{
  id: "log-uuid",
  tenantId: "tenant-uuid",
  actorId: "user-uuid",          // –∫—Ç–æ —Å–æ–≤–µ—Ä—à–∏–ª –¥–µ–π—Å—Ç–≤–∏–µ
  actorRole: "RESTAURANT_ADMIN",
  actionType: "BALLS_MANUALLY_ADJUSTED",
  entityType: "GUEST_CARD",
  entityId: "card-uuid",
  oldValue: { balance: 1000 },
  newValue: { balance: 1500 },
  reason: "–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞ –ø—Ä–æ–±–ª–µ–º—É —Å –∑–∞–∫–∞–∑–æ–º",
  ipAddress: "192.168.1.100",
  userAgent: "Mozilla/5.0...",
  createdAt: "2024-12-01T15:30:00Z"
}
```

–î–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
- –°–æ–∑–¥–∞–Ω–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –†—É—á–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ/—Å–ø–∏—Å–∞–Ω–∏–µ –±–∞–ª–ª–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–Ω–∞–ø—à–æ—Ç–∞ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏)
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π –∏ –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–π
- –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É, –≤—ã—Ö–æ–¥, impersonation
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ POS-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

### –ü—Ä–∏–Ω—Ü–∏–ø 3: –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∞–ª–ª–∞–º–∏

–ö–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è/—Å–ø–∏—Å–∞–Ω–∏—è –±–∞–ª–ª–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–π** ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ —Å —Ç–µ–º –∂–µ `idempotencyKey` –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

```typescript
// –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–ø—Ä–æ—Å–∞
POST /api/v1/loyalty/calculate
X-Idempotency-Key: pos-iiko-check-12345-2024-12-01

// –ï—Å–ª–∏ –∫–ª—é—á —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Redis ‚Üí –≤–µ—Ä–Ω—É—Ç—å cached response
// –ï—Å–ª–∏ –∫–ª—é—á –Ω–æ–≤—ã–π ‚Üí –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é + —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Redis (TTL 24 —á–∞—Å–∞)
```

### –ü—Ä–∏–Ω—Ü–∏–ø 4: –£—Ä–æ–≤–µ–Ω—å ‚Äî —Ç–æ–ª—å–∫–æ –≤–≤–µ—Ä—Ö (One-Way-Up)

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —É—Ä–æ–≤–µ–Ω—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –≥–æ—Å—Ç—è **–º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–∞—Å—Ç–∏**. –ü–æ–Ω–∏–∂–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –¥–∞–∂–µ –µ—Å–ª–∏ –≥–æ—Å—Ç—å –ø–µ—Ä–µ—Å—Ç–∞–ª –ø–æ—Å–µ—â–∞—Ç—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω. –≠—Ç–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –≥–æ—Å—Ç—å –Ω–µ —Ç–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å.

*–ò—Å–∫–ª—é—á–µ–Ω–∏–µ:* Admin –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é –ø–æ–Ω–∏–∑–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º, –∏ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è.

### –ü—Ä–∏–Ω—Ü–∏–ø 5: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –∏ –ø—Ä–æ–º–æ-–±–∞–ª–ª–æ–≤

–ë–∞–ª–∞–Ω—Å –≥–æ—Å—Ç—è –≤—Å–µ–≥–¥–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π:

```
–û–±—â–∏–π –±–∞–ª–∞–Ω—Å = RegularBalance + PromoBalance
                    ‚îÇ                 ‚îÇ
            –ë–µ—Å—Å—Ä–æ—á–Ω—ã–µ –±–∞–ª–ª—ã    –ë–∞–ª–ª—ã —Å–æ —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è
            (–∑–∞ –ø–æ–∫—É–ø–∫–∏)        (–∑–∞ –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–∏)
                                      ‚îÇ
                              –°–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å
                              (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
```

–ü—Ä–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∫–∏ —Å–Ω–∞—á–∞–ª–∞ —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è **–ø—Ä–æ–º–æ-–±–∞–ª–ª—ã** (—É –∫–æ—Ç–æ—Ä—ã—Ö —Å–∫–æ—Ä–æ –∏—Å—Ç–µ—á—ë—Ç —Å—Ä–æ–∫), –∑–∞—Ç–µ–º ‚Äî –æ–±—ã—á–Ω—ã–µ.

---

*–°–µ—Å—Å–∏—è S-01 –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –°–ª–µ–¥—É—é—â–∞—è ‚Äî S-02: Auth-—Å–∏—Å—Ç–µ–º–∞ (JWT, refresh, 2FA, MFA), –º—É–ª—å—Ç–∏–∞—Ä–µ–Ω–¥–Ω–æ—Å—Ç—å, rate-limiting.*

---

<!-- S-02: Auth-—Å–∏—Å—Ç–µ–º–∞ (JWT, refresh, 2FA), –º—É–ª—å—Ç–∏–∞—Ä–µ–Ω–¥–Ω–æ—Å—Ç—å, rate-limiting ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Å—Å–∏–∏ -->
<!-- S-03: Loyalty Engine: –ø—Ä–∞–≤–∏–ª–∞, —É—Ä–æ–≤–Ω–∏, –ø—Ä–æ–º–æ, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã, —Ä–∞—Å—á—ë—Ç –±–∞–ª–ª–æ–≤ -->
<!-- S-04: POS-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: iiko, R-Keeper, webhook-flow, reconciliation -->
<!-- S-05: Frontend Admin Panel, Manager Dashboard, Cashier Interface -->
<!-- S-06: Telegram Mini App, Notifications, Billing & Subscriptions -->
<!-- S-07: Analytics, Infrastructure, Security, GDPR, –∏—Ç–æ–≥–æ–≤—ã–µ —Å—Ö–µ–º—ã -->
